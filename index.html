<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cloud Marketing Analytics Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
    <style>
        .card {
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }
        .data-table {
            font-family: Arial, sans-serif;
            border-collapse: collapse;
            width: 100%;
        }
        .data-table td, .data-table th {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        .data-table tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        .data-table tr:hover {
            background-color: #e9f7fe;
        }
        .data-table th {
            padding-top: 12px;
            padding-bottom: 12px;
            background-color: #4285f4;
            color: white;
        }
        .pill {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.875rem;
            font-weight: 600;
        }
    </style>
</head>
<body class="bg-gray-50">
    <div class="container mx-auto px-4 py-8">
        <!-- Header with GCP connection status -->
        <div class="flex justify-between items-center mb-8">
            <div>
                <h1 class="text-3xl font-bold text-gray-800">Marketing Analytics Dashboard</h1>
                <p class="text-gray-600">Powered by Google Cloud Platform</p>
            </div>
            <div class="flex items-center space-x-4">
                <div class="flex items-center">
                    <div class="w-3 h-3 rounded-full bg-green-500 mr-2"></div>
                    <span class="text-sm text-gray-600">Connected to BigQuery</span>
                </div>
                <div class="flex items-center">
                    <img src="https://placehold.co/40x40?text=GCP" alt="Google Cloud Platform logo" class="w-8 h-8 mr-2">
                    <img src="https://placehold.co/40x40?text=GDS" alt="Google Data Studio logo" class="w-8 h-8">
                </div>
            </div>
        </div>

        <!-- Data source and date range selector -->
        <div class="bg-white rounded-lg shadow p-6 mb-8">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Data Source</label>
                    <select class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option>Google Sheets - Marketing Campaigns 2023</option>
                        <option>Google Ads API</option>
                        <option>Facebook Ads API</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Date Range</label>
                    <select class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option>Last 30 Days</option>
                        <option>Last Quarter</option>
                        <option>Last Year</option>
                        <option>Custom Range</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Platform</label>
                    <select class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option>All Platforms</option>
                        <option>Google Ads</option>
                        <option>Facebook</option>
                        <option>LinkedIn</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- KPI Cards -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
            <div class="card bg-white rounded-lg shadow p-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-medium text-gray-500">Impressions</h3>
                    <span class="pill bg-blue-100 text-blue-800">+12%</span>
                </div>
                <p class="text-3xl font-bold text-gray-800">2.4M</p>
                <p class="text-sm text-gray-500 mt-1">vs 2.1M previous period</p>
            </div>
            <div class="card bg-white rounded-lg shadow p-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-medium text-gray-500">Clicks</h3>
                    <span class="pill bg-green-100 text-green-800">+8%</span>
                </div>
                <p class="text-3xl font-bold text-gray-800">48,923</p>
                <p class="text-sm text-gray-500 mt-1">vs 45,274 previous period</p>
            </div>
            <div class="card bg-white rounded-lg shadow p-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-medium text-gray-500">Conversions</h3>
                    <span class="pill bg-purple-100 text-purple-800">+22%</span>
                </div>
                <p class="text-3xl font-bold text-gray-800">1,248</p>
                <p class="text-sm text-gray-500 mt-1">vs 1,023 previous period</p>
            </div>
            <div class="card bg-white rounded-lg shadow p-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-medium text-gray-500">CTR</h3>
                    <span class="pill bg-red-100 text-red-800">-3%</span>
                </div>
                <p class="text-3xl font-bold text-gray-800">2.04%</p>
                <p class="text-sm text-gray-500 mt-1">vs 2.10% previous period</p>
            </div>
        </div>

        <!-- Main Charts -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
            <div class="card bg-white rounded-lg shadow p-6">
                <h3 class="text-lg font-medium text-gray-800 mb-4">Performance Over Time</h3>
                <div class="h-64">
                    <canvas id="performanceChart"></canvas>
                </div>
            </div>
            <div class="card bg-white rounded-lg shadow p-6">
                <h3 class="text-lg font-medium text-gray-800 mb-4">Platform Distribution</h3>
                <div class="h-64">
                    <canvas id="platformChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Campaign Table -->
        <div class="card bg-white rounded-lg shadow overflow-hidden mb-8">
            <div class="p-6">
                <h3 class="text-lg font-medium text-gray-800 mb-4">Campaign Performance</h3>
                <div class="overflow-x-auto">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Campaign Name</th>
                                <th>Platform</th>
                                <th>Impressions</th>
                                <th>Clicks</th>
                                <th>CTR</th>
                                <th>Conversions</th>
                                <th>Cost</th>
                                <th>CPA</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Summer Sale 2023</td>
                                <td>Google Ads</td>
                                <td>452,821</td>
                                <td>9,501</td>
                                <td>2.10%</td>
                                <td>387</td>
                                <td>$12,457</td>
                                <td>$32.19</td>
                            </tr>
                            <tr>
                                <td>Back to School</td>
                                <td>Facebook</td>
                                <td>387,624</td>
                                <td>7,845</td>
                                <td>2.02%</td>
                                <td>284</td>
                                <td>$9,756</td>
                                <td>$34.35</td>
                            </tr>
                            <tr>
                                <td>Holiday Promo</td>
                                <td>LinkedIn</td>
                                <td>215,397</td>
                                <td>3,245</td>
                                <td>1.51%</td>
                                <td>187</td>
                                <td>$8,912</td>
                                <td>$47.66</td>
                            </tr>
                            <tr>
                                <td>Product Launch</td>
                                <td>Google Ads</td>
                                <td>321,785</td>
                                <td>6,927</td>
                                <td>2.15%</td>
                                <td>295</td>
                                <td>$10,345</td>
                                <td>$35.07</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- SQL Query Panel -->
        <div class="card bg-white rounded-lg shadow overflow-hidden">
            <div class="p-6">
                <h3 class="text-lg font-medium text-gray-800 mb-4">BigQuery SQL</h3>
                <div class="bg-gray-900 rounded-md overflow-hidden mb-4">
                    <pre class="text-green-400 p-4 overflow-x-auto">
<code>-- Sample query running in BigQuery
SELECT 
    campaign_name,
    platform,
    SUM(impressions) AS impressions,
    SUM(clicks) AS clicks,
    ROUND(SUM(clicks)/SUM(impressions)*100, 2) AS ctr,
    SUM(conversions) AS conversions,
    SUM(cost) AS cost,
    ROUND(SUM(cost)/SUM(conversions), 2) AS cpa
FROM 
    `marketing_data.campaign_performance`
WHERE 
    date BETWEEN '2023-01-01' AND '2023-12-31'
GROUP BY 
    campaign_name, platform
ORDER BY 
    impressions DESC
LIMIT 10</code>
                    </pre>
                </div>
                <div class="flex justify-between items-center">
                    <p class="text-sm text-gray-600">Results from BigQuery connected to Google Sheets data source</p>
                    <button class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md text-sm font-medium transition duration-150 ease-in-out">
                        Run Query in BigQuery
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const WEB_APP_URL = "const WEB_APP_URL = "https://script.google.com/macros/s/AKfycby1w_8Q_2dIcFuA5AR7-My76cPj-DXcIZfzf8YO_zvmNQvWlT3HtColveOroo2F0WILTw/exec";
        // Performance Over Time Line Chart
        const performanceCtx = document.getElementById('performanceChart').getContext('2d');
        const performanceChart = new Chart(performanceCtx, {
            type: 'line',
            data: {
                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                datasets: [
                    {
                        label: 'Impressions',
                        data: [120000, 110000, 150000, 160000, 180000, 200000, 220000, 210000, 230000, 240000, 250000, 260000],
                        borderColor: '#4285F4',
                        backgroundColor: 'rgba(66, 133, 244, 0.1)',
                        tension: 0.3,
                        fill: true
                    },
                    {
                        label: 'Clicks',
                        data: [2500, 3000, 3500, 3800, 4000, 4500, 5000, 4900, 5200, 5300, 5500, 5600],
                        borderColor: '#34A853',
                        backgroundColor: 'rgba(52, 168, 83, 0.1)',
                        tension: 0.3,
                        fill: true
                    },
                    {
                        label: 'Conversions',
                        data: [85, 90, 110, 115, 120, 130, 140, 135, 145, 150, 155, 160],
                        borderColor: '#EA4335',
                        backgroundColor: 'rgba(234, 67, 53, 0.1)',
                        tension: 0.3,
                        fill: true
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom'
                    },
                    tooltip: {
                        mode: 'index',
                        intersect: false
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            callback: function(value) {
                                if (value >= 1000) {
                                    return value / 1000 + 'k';
                                }
                                return value;
                            }
                        }
                    }
                }
            }
        });

        // Platform Distribution Doughnut Chart
        const platformCtx = document.getElementById('platformChart').getContext('2d');
        const platformChart = new Chart(platformCtx, {
            type: 'doughnut',
            data: {
                labels: ['Google Ads', 'Facebook', 'LinkedIn', 'Twitter', 'TikTok'],
                datasets: [{
                    data: [45, 30, 15, 7, 3],
                    backgroundColor: [
                        '#4285F4',
                        '#1877F2',
                        '#0077B5',
                        '#1DA1F2',
                        '#000000'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom'
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return `${context.label}: ${context.raw}%`;
                            }
                        }
                    }
                }
            }
        });

        // Simulate BigQuery API call
        document.querySelector('button').addEventListener('click', function() {
            alert('This would execute the SQL query in BigQuery and refresh the dashboard with new data from the Google Sheets source.');
        });

        // Update data based on dropdown selections
        document.querySelectorAll('select').forEach(select => {
            select.addEventListener('change', function() {
                alert('This would filter the dashboard data based on your selection criteria.');
            });
        });
    </script>
</body>
</html>
